<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta author="Carson Woods">
    <title>Ad Fraud</title>
    <link rel="stylesheet" href="css/main.css">

    <script type="application/javascript">

    //Global Variables
    var width; //canvas width
    var height; //canvas height
    var canvas; //the canvas
    var ctx;  //the context
    var currentScene; //leave uninitialized to start from beginning
    var intervals = []; //sets intervals for later clearing

    //image variables
    var overview = new Image();
    var archictecture = new Image();
    var validAdvertisement = new Image();
    var spoofedAdvertisement = new Image();
    var arrowImage = new Image();
    var user = new Image();
    var localDNS = new Image();
    var webServer = new Image();
    var attacker = new Image();
    var internetDNS = new Image();
    var poisonedDNS = new Image();
    var maliciousWebsite = new Image();
    var maliciousResolver = new Image();
    var maliciousIP = new Image();
    var adNetwork = new Image();
    var genericServer = new Image();
    var googleScreenshotOne = new Image();
    var googleScreenshotTwo = new Image();
    var nortonScreenshot = new Image();

    //adds event listener on the window load so the system doesn't prematurely try
    //to load the canvas and context.
    window.addEventListener('load', eventWindowLoaded, false);

    function eventWindowLoaded() {
      //sets canvas and context based on the DOM element Canvas
      canvas = document.getElementById('canvas')
      ctx = canvas.getContext('2d');
      width = canvas.width;
      height = canvas.height;
    }

    function init() {


      //load assets for images from CDN.
      //Note: Local storage is possible but behaves poorly when running from dev console
      overview.src = './assets/overview.png';
      archictecture.src = './assets/architecture.png';
      validAdvertisement.src = './assets/validAdvertisement.png';
      spoofedAdvertisement.src = './assets/spoofedAdvertisement.png';
      arrowImage.src = './assets/arrow.png';
      user.src = './assets/user.png';
      localDNS.src = './assets/localDNS.png';
      webServer.src = './assets/webServer.png';
      attacker.src = './assets/attacker.png';
      internetDNS.src = './assets/internetDNS.png';
      poisonedDNS.src = './assets/poisonedDNS.png';
      maliciousWebsite.src = './assets/maliciousWebsite.png';
      maliciousResolver.src= './assets/maliciousResolver.png';
      maliciousIP.src = './assets/maliciousIP.png';
      adNetwork.src = './assets/adNetwork.png';
      genericServer.src = './assets/maliciousIP.png';
      googleScreenshotOne.src = './assets/googleScreenshot.png';
      googleScreenshotTwo.src = './assets/googleScreenshot2.png';
      nortonScreenshot.src = './assets/nortonScreenshot.png';


      //loads the first scene
      if (currentScene === 1) {
        sceneOne();
      } else if (currentScene === 2) {
        sceneTwo();
      } else if (currentScene === 3) {
        sceneThree();
      } else if (currentScene === 4) {
        sceneFour();
      } else if (currentScene === 5) {
        sceneFive();
      } else if (currentScene === 6) {
        sceneSix();
      } else if (currentScene === 7) {
        sceneSeven();
      } else if (currentScene === 8) {
        sceneEight();
      } else if (currentScene === 9) {
        sceneNine();
      } else if (currentScene === 10) {
        sceneTen();
      } else if (currentScene === 11) {
        sceneEleven();
      } else if (currentScene === 12) {
        sceneTwelve();
      } else if (currentScene === 13) {
        sceneThirteen();
      } else if (currentScene === 14) {
        sceneFourteen();
      } else if (currentScene === 15) {
        sceneFifteen();
      } else if (currentScene === 16) {
        sceneSixteen();
      } else if (currentScene === 17) {
        sceneSeventeen();
      } else if (currentScene === 18) {
        sceneEighteen();
      } else if (currentScene === 19) {
        sceneNineteen();
      } else if (currentScene === 20) {
        sceneTwenty();
      } else if (currentScene === 21) {
        sceneTwentyOne();
      } else if (currentScene === 22) {
        sceneTwentyTwo();
      } else if (currentScene === 23) {
        sceneTwentyThree();
      } else {
        sceneOne();
      }

    }

    function sceneOne() {
      //sets the current scene
      currentScene = 1;

      //clears any previous drawings
      ctx.clearRect(0,0,width,height);

      //sets font and font size for the following text
      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Ad Fraud Prevention", 200, 200);
      ctx.fillText("An Interactive Demo", 200, 450);
      var sceneOneTimer = setInterval(function(){
        fadeIn("Use the arrow keys to continue", 250, 300, 20, width);
        clearInterval(sceneOneTimer);
      }, 2000)
      intervals.push(sceneOneTimer);

      //tests for next scene input key
      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key == 39) {
          intervals.forEach(clearInterval);
          sceneTwo();
        }

      }

    }

    function sceneTwo() {
      //sets the current scene
      currentScene = 2;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "50pt Arial";
      ctx.fillText("Introduction", 275, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            fadeIn("Online Advertisement has Significantly changed", 175, 150, 20, width);
            fadeIn("the landscape of the advertisement industry", 190, 180, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("Benefits Include: ", 140, 220, 15, width);
            subSection++;
          } else if(subSection === 2) {
            fadeIn("- Cost Efficiency", 160, 245, 12, width);
            fadeIn("- Convenience in targeting relevant market segment", 160, 270, 12, width);
            fadeIn("- Ability to quickly disseminate content changes", 160, 295, 12, width);
            fadeIn("- Track consumers in real time", 160, 320, 12, width);
            subSection++;
          } else if(subSection === 3) {
            intervals.forEach(clearInterval);
            fadeIn("Benefits come with Challenges:", 140, 350, 15, width);
            subSection++;
          } else if (subSection === 4) {
            fadeIn("- Click Fraud", 160, 375, 12, width);
            fadeIn("- Ad Replacement", 160, 400, 12, width);
            fadeIn("- Ad Stacking", 160, 425, 12, width);
            subSection++;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            ctx.fillStyle = "rgba(0, 0, 0, 1)";
            ctx.font = "15pt Arial";
            ctx.fillText("Press the right arrow key to continue", 550, 550);
            subSection++;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval);
            sceneThree();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneOne();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(150, 110, width, 80);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(140, 205, width, 20);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(120, 230, width, 1250);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(80, 325, width, 40);
            subSection--;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            ctx.clearRect(120, 360, width, 100);
            subSection--;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval);
            ctx.clearRect(550, 510, 400, 50);
            subSection--;
          }
        }

      }
    }

    function sceneThree() {
      //sets the current scene
      currentScene = 3;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Online Advertisement Overview", 100, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Parties Involved", 150, 130, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("Advertisers: entity who would like to advertise their product", 160, 155, 12, width);
            fadeIn("Publisher: website owners hosting the ad", 160, 180, 12, width);
            fadeIn("Ad Network: Mediator between publisher and advertiser", 160, 205, 12, width);
            subSection++;
          } else if(subSection === 2) {
            intervals.forEach(clearInterval);
            fadeIn("Advertisers pay Ad Network", 20, 395, 12, 225);
            fadeIn("for displaying their ads", 20, 420, 12, 225);
            fadeIn("Ad Network split revenue generated", 20, 450, 12, 275);
            fadeIn("by ads with the publisers", 20, 480, 12, 275);
            fadeIn("Advertisers", 715, 320, 12, 225);
            fadeIn("Publishers", 715, 480, 12, 225);
            ctx.drawImage(overview, 300, 300, 400, 200);
            subSection++;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            sceneFour();
          }
        }
        if (key === 37) {
          if (subSection === 0) {
            sceneTwo();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(150, 110, width, 80);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(120, 140, width, 400);
            subSection--;
          } else if (subSection === 3) {
            ctx.clearRect(0, 210, width, 500);
            intervals.forEach(clearInterval);
            subSection--;
          }
        }
      }
    }

    function sceneFour() {
      //sets the current scene
      currentScene = 4;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Advertisement Revenue Model", 100, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Common Revenue Types", 50, 130, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("Cost per mille (CPM) : Amount advertisers are charged per thousand views or impressions", 80, 155, 15, width);
            fadeIn("Cost per click (CPC) :  Amount advertisers are charged per click", 80, 180, 15, width);
            fadeIn("Cost per action (CPA) : Amount advertisers are charged per action, e.g. Online Sale", 80, 205, 15, width);
            subSection++;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            sceneFive();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneThree();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 110, width, 80);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 140, width, 200);
            subSection--;
          }
        }

      }
    }

    function sceneFive() {
      //sets the current scene
      currentScene = 5;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Ad Serving Architecture", 175, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            intervals.forEach(clearInterval);
            ctx.drawImage(archictecture, 125, 100, 700, 500);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            sceneSix();
            subSection++;
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneFour();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            subSection--;
          }
        }

      }
    }

    function sceneSix() {
      //sets the current scene
      currentScene = 6;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Domain Name System", 180, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {
          if(subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("One major source for ad fraud occurs in insecure DNS servers.", 160, 110, 15, width);
            subSection++;
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("DNS translates internet domains and host names to ip addresses.", 160, 140, 15, width);
            subSection++;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.drawImage(user, 50, 475, 100, 100);
            ctx.fillText("User", 50, 585);
            ctx.drawImage(webServer, 400, 175, 100, 100);
            ctx.fillText("Web Server", 400, 290);
            ctx.drawImage(localDNS, 750, 475, 100, 100);
            ctx.fillText("Local DNS Server", 730, 580);
            subSection++;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval)
            lineDraw(160, 500, 740, 500);
            fadeIn("1. User’s browser requests for IP address of ebay.com", 200, 485, 12, 400);
            subSection++;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval)
            lineDraw(160, 550, 740, 550);
            fadeIn("2.DNS returns the IP Address to the user 66.135.217.240", 200, 570, 12, 425);
            subSection++;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            fadeIn("3. User’s browser accesses the website", 50, 200, 12, 290);
            fadeIn("by sending HTTP request to ", 50, 225, 12, 250);
            fadeIn("66.135.217.240 Web Server", 50, 250, 12, 250);
            lineDraw(50, 475, 400, 190);
            subSection++;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval);
            lineDraw(150, 475, 400, 290);
            fadeIn("4. Web Server sends HTTP ", 350, 365, 12, 200);
            fadeIn("response to the User", 350, 390, 12, 200);
            subSection++;
          } else if (subSection === 7) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 0, width, height);
            sceneSeven();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneFive();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(160, 90, width, height);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(160, 120, width, height);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 175, width, height);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(160, 465, 590, 40)
            subSection--;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            ctx.clearRect(160, 520, 590, 40)
            ctx.clearRect(160, 550, 500, 40)
            subSection--;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval)
            ctx.clearRect(50, 180, 350, 290);
            ctx.clearRect(50, 180, 50, 300);
            subSection--;
          } else if (subSection === 7) {
            intervals.forEach(clearInterval);
            ctx.clearRect(290, 289, 300, 180);
            ctx.clearRect(190, 365, 110, 100);
            ctx.clearRect(125, 425, 75, 55);
            subSection--;
          }
        }

      }
    }

    function sceneSeven() {
      //sets the current scene
      currentScene = 7;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("DNS Cache Poisoning", 180, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {
          if(subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("This is a computer hacking attack where a hacker floods", 125, 125, 20, width);
            fadeIn("a DNS Cache with fake IP Addresses.", 220, 160, 20, width)
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("Local DNS Server- Keeps the IP Addresses which user uses frequently. ", 25, 225, 20, width);
            fadeIn("If user asks IP address of a web server which is not ", 115, 260, 20, width)
            fadeIn("stored in Local DNS Server, it queries the Internet DNS Server.", 80, 295, 20, width)
            subSection++;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            fadeIn("Internet DNS Server- It stores all the Web server", 150, 360, 20, width)
            fadeIn("names and their corresponding IP Address", 180, 390, 20, width)
            subSection++;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            sceneEight();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneSix();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,100,width,height);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,200,width,height);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,300,width,height);
            subSection--;
          }
        }

      }
    }

    function sceneEight() {
      //sets the current scene
      currentScene = 8;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "30pt Arial";
      ctx.fillText("DNS Cache Poisoning", 250, 50);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {
          if(subSection === 0) {
            intervals.forEach(clearInterval);
            ctx.drawImage(attacker, 50, 440, 125, 100);
            ctx.drawImage(localDNS, 750, 440, 125, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("Attacker", 70, 590);
            ctx.fillText("Local DNS", 750, 590);
            subSection++;
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.drawImage(attacker, 50, 440, 125, 100);
            ctx.drawImage(localDNS, 750, 440, 125, 100);
            lineDraw(200, 480, 700, 480);
            fadeIn("1. Resolve IP address of http://maddox.xmission.com", 225, 460, 13, 450);
            fadeIn("Step 1: Attacker chooses a website and asks Local DNS server for the IP address", 125, 100, 13, 675);
            fadeIn("For e.g. http://maddox.xmission.com, hoping that it will query Internet DNS Server.", 125, 125, 13, 675);
            subSection++;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            lineDraw(750, 500, 500, 250)
            fadeIn("Step 2: If Local DNS Server will not have the IP Address of the requested website,", 125, 100, 13, 675);
            fadeIn("Local DNS Server will query Internet DNS Server for the IP Address. ", 125, 125, 13, 675);
            fadeIn("2. Local DNS Server will query Internet DNS Server", 550, 250, 11, 675);
            fadeIn("for the IP Address of http://maddox.xmission.com", 550, 275, 11, 675);
            subSection++;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            fadeIn("Step 3: After sending the request to Internet DNS Server, ", 125, 90, 13, 675);
            fadeIn("Local DNS Server will wait for response from Internet DNS Server.", 125, 115, 13, 675);
            fadeIn("Here, Attacker will get a chance to flood the Local DNS Server with fake responses.", 125, 140, 13, 675);
            fadeIn("3 b. 166.70.245.8", 600, 300, 13, 675);
            lineDraw(750, 500, 500, 250);
            fadeIn("3 a.  120.34.231.3", 375, 460, 13, 200);
            lineDraw(200, 475, 700, 475);
            fadeIn("3 c.  180.48.155.1", 375, 550, 13, 200);
            lineDraw(200, 525, 700, 525);
            subSection++;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            fadeIn("Step 4: If Local DNS Server is not protected with secured connection,", 125, 90, 13, 675);
            fadeIn("it can receive the fake/malicious IP Address coming from the Attacker.", 125, 115, 13, 675);
            lineDraw(200, 480, 700, 480);
            fadeIn("4. Recieves the fake response 120.34.231.3 coming from the attacker", 175, 460, 13, 600);
            subSection++;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            fadeIn("Step 5. It will send it back to the attacker.", 75, 90, 13, 800);
            fadeIn("Step 5 a. Also it will update this malicious IP corresponding to the website http://maddox.xmission.com.", 75, 115, 13, 800);
            fadeIn("Now the Local DNS Server is containing a malicious IP Address, hence it is Poisoned.", 75, 140, 13, 800);
            lineDraw(200, 480, 700, 480);
            fadeIn("5. Sends response 120.34.231.3 back to the attacker.", 200, 460, 13, 425);
            fadeIn("5 a. Updates the IP Address of http://maddox.xmission.com", 500, 350, 11, 675);
            fadeIn("with malicious IP Address 120.34.231.3 in its directory.", 500, 375, 11, 675);
            subSection++;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval);
            sceneNine();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneSeven();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,100,width,height);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,75,width,150);
            ctx.clearRect(200,400,500,150);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0,80,width,height);
            ctx.drawImage(attacker, 50, 440, 125, 100);
            ctx.drawImage(localDNS, 750, 440, 125, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("Attacker", 70, 590);
            ctx.fillText("Local DNS", 750, 590);
            lineDraw(200, 480, 700, 480);
            fadeIn("1. Resolve IP address of http://maddox.xmission.com", 225, 460, 13, 450);
            fadeIn("Step 1: Attacker chooses a website and asks Local DNS server for the IP address", 125, 100, 13, 675);
            fadeIn("For e.g. http://maddox.xmission.com, hoping that it will query Internet DNS Server.", 125, 125, 13, 675);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            lineDraw(750, 500, 500, 250);
            fadeIn("Step 2: If Local DNS Server will not have the IP Address of the requested website,", 125, 100, 13, 675);
            fadeIn("Local DNS Server will query Internet DNS Server for the IP Address. ", 125, 125, 13, 675);
            fadeIn("2. Local DNS Server will query Internet DNS Server", 550, 250, 11, 675);
            fadeIn("for the IP Address of http://maddox.xmission.com", 550, 275, 11, 675);
            subSection--;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            fadeIn("Step 3: After sending the request to Internet DNS Server, ", 125, 90, 13, 675);
            fadeIn("Local DNS Server will wait for response from Internet DNS Server.", 125, 115, 13, 675);
            fadeIn("Here, Attacker will get a chance to flood the Local DNS Server with fake responses.", 125, 140, 13, 675);
            fadeIn("3 b. 166.70.245.8", 600, 300, 13, 675);
            lineDraw(750, 500, 500, 250);
            fadeIn("3 a.  120.34.231.3", 375, 460, 13, 200);
            lineDraw(200, 475, 700, 475);
            fadeIn("3 c.  180.48.155.1", 375, 550, 13, 200);
            lineDraw(200, 525, 700, 525);
            subSection--;
          } else if (subSection === 6) {
            intervals.forEach(clearInterval);
            restoreDNSPoisoningScene();
            fadeIn("Step 4: If Local DNS Server is not protected with secured connection,", 125, 90, 13, 675);
            fadeIn("it can receive the fake/malicious IP Address coming from the Attacker.", 125, 115, 13, 675);
            lineDraw(200, 480, 700, 480);
            fadeIn("4. Recieves the fake response 120.34.231.3 coming from the attacker", 175, 460, 13, 600);
            subSection--;
          }
        }

      }
    }

    function sceneNine() {
      //sets the current scene
      currentScene = 9;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("DNS Cache Pharming", 180, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            fadeIn("An attack where user is taken to a different, usually malicious", 100, 150, 20, width);
            fadeIn("website instead of the one he wanted to visit.", 100, 180, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("DNS Pharming exploits DNS Cache Poisoning.", 100, 240, 20, width);
            subSection++;
          } else if(subSection === 2) {
            fadeIn("DNS Cache Poisoning is used to do Pharming attack.", 100, 270, 20, width);
            subSection++;
          } else if(subSection === 3) {
            intervals.forEach(clearInterval);
            fadeIn("If a DNS Server is already poisoned, now if any user requests this ", 100, 350, 20, width);
            fadeIn("poisoned DNS Server for the IP Address of a website it will send ", 100, 380, 20, width);
            fadeIn("the Malicious IP Address", 100, 410, 20, width);
            subSection++;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.fillStyle = "rgba(0, 0, 0, 1)";
            ctx.font = "15pt Arial";
            ctx.fillText("Press the right arrow key to continue", 550, 550);
            subSection++;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            sceneTen();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneEight();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(100, 110, width, 80);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(100, 220, width, 60);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(100, 245, width, 60);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(80, 325, width, height);
            subSection--;
          }  else if (subSection === 5) {
            intervals.forEach(clearInterval);
            ctx.clearRect(80, 500, width, height);
            subSection--;
          }
        }
      }
    }

    function sceneTen() {
      //sets the current scene
      currentScene = 10;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("DNS Pharming", 280, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Step 1: User requests for an IP Address of http://maddox.xmission.com", 140, 120, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            lineDraw(200, 480, 700, 480);
            fadeIn("1. User Requests for IP Address of http://maddox.xmission.com", 200, 460, 13, 500);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("Step 2: Since the Local DNS Server in now poisoned,", 140, 120, 15, width);
            fadeIn("it will return the malicious IP Address i.e. IP Address of a malicious website.", 140, 145, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            lineDraw(200, 480, 700, 480);
            fadeIn("2. DNS Server sends back Malicious IP Address 120.34.231.3", 200, 460, 13, 500);
            subSection++;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 3: After receiving the malicious IP Address the User unintentionally", 140, 120, 15, width);
            fadeIn("makes an HTTP Request for the Malicious website. ", 140, 145, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.drawImage(maliciousWebsite, 400, 150, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            ctx.fillText("Malicous Website", 400, 270);
            lineDraw(130, 420, 390, 200);
            fadeIn("3. HTTP Request for 120.34.231.3", 40, 250, 13, 275);
            subSection++
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 4: Then the malicious website will send the HTTP response to the user.", 140, 120, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.drawImage(maliciousWebsite, 400, 150, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            ctx.fillText("Malicous Website", 400, 270);
            lineDraw(130, 420, 390, 200);
            fadeIn("4. HTTP Response", 40, 250, 13, 275);
            subSection++
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 5: User have been taken to a malicious IP Address unintentionally. ", 140, 120, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.drawImage(maliciousWebsite, 400, 150, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            ctx.fillText("Malicous Website", 400, 270);
            lineDraw(130, 420, 390, 200);
            fadeIn("5. User will access the", 40, 250, 13, 275);
            fadeIn("malicious website", 40, 275, 13, 200);
            subSection++;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            sceneEleven()
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneNine();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(100, 100, width, height);
            fadeIn("Step 1: User requests for an IP Address of http://maddox.xmission.com", 140, 120, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            lineDraw(200, 480, 700, 480);
            fadeIn("1. User Requests for IP Address of http://maddox.xmission.com", 200, 460, 13, 500);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 2: Since the Local DNS Server in now poisoned,", 140, 120, 15, width);
            fadeIn("it will return the malicious IP Address i.e. IP Address of a malicious website.", 140, 145, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            lineDraw(200, 480, 700, 480);
            fadeIn("2. DNS Server sends back Malicious IP Address 120.34.231.3", 200, 460, 13, 500);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 3: After receiving the malicious IP Address the User unintentionally", 140, 120, 15, width);
            fadeIn("makes an HTTP Request for the Malicious website. ", 140, 145, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.drawImage(maliciousWebsite, 400, 150, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            ctx.fillText("Malicous Website", 400, 270);
            lineDraw(130, 420, 390, 200);
            fadeIn("3. HTTP Request for 120.34.231.3", 40, 250, 13, 275);
            subSection--;
          } else if (subSection === 5) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            fadeIn("Step 4: Then the malicious website will send the HTTP response to the user.", 140, 120, 15, width);
            ctx.drawImage(user, 50, 450, 100, 100);
            ctx.drawImage(poisonedDNS, 750, 450, 100, 100);
            ctx.drawImage(maliciousWebsite, 400, 150, 100, 100);
            ctx.font = "15pt Arial";
            ctx.fillText("User", 65, 575);
            ctx.fillText("Poisoned DNS Server", 700, 575);
            ctx.fillText("Malicous Website", 400, 270);
            lineDraw(130, 420, 390, 200);
            fadeIn("4. HTTP Response", 40, 250, 13, 275);
            subSection--;
          }
        }

      }

    }

    function sceneEleven() {
      //sets the current scene
      currentScene = 11;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "25pt Arial";
      ctx.fillText("Malicious DNS Resolver : Exploits DNS Pharming", 85, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;


      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if (subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Malicious DNS Resolver:", 100, 120, 20, width);
            fadeIn("Attackers changes DNS resolver setting to attacker controlled Malicious Resolver", 100, 160, 15, width);
            fadeIn("Malicious resolver provides Incorrect IP addresses which are controlled", 100, 190, 15, width);
            fadeIn("by attackers using DNS Pharming Technique.", 100, 215, 15, width);
            subSection++;
          } else if (subSection ===1) {
            intervals.forEach(clearInterval);
            sceneTwelve();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneTen();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            subSection--;
          }
        }
    }
  }

  function sceneTwelve() {
    //sets the current scene
    currentScene = 12;

    //clears canvas
    ctx.clearRect(0,0,width,height);

    ctx.fillStyle = "rgba(0, 0, 0, 1)";
    ctx.font = "40pt Arial";
    ctx.fillText("Ad Replacement Attack", 175, 75);

    //incrementable flag to determine progress through scene
    var subSection = 0;

    window.onkeyup = function(e) {
      var key = e.keyCode ? e.keyCode : e.which;

      if (key === 39) {

        if(subSection === 0) {
          intervals.forEach(clearInterval);
          fadeIn("Attackers are malicious publishers who infected the victim machine", 150, 155, 15, width);
          fadeIn("with DNS Changer malware", 150, 180, 15, width);
          subSection++;
        } else if(subSection === 1) {
          intervals.forEach(clearInterval);
          fadeIn("Together with Rogue DNS Servers, the attackers replaced", 150, 220, 15, width);
          fadeIn("legitimate ads on websites with attacker’s ads", 150, 245, 15, width);
          subSection++;
        } else if(subSection === 2) {
          intervals.forEach(clearInterval);
          fadeIn("Ad Fraud helped attackers earn 14 million USD over a period of 4 years", 150, 285, 15, width);
          subSection++;
        } else if(subSection === 3) {
          intervals.forEach(clearInterval);
          sceneThirteen();
        }
      }

      if (key === 37) {
        if (subSection === 0) {
          sceneEleven();
        } else if (subSection === 1) {
          intervals.forEach(clearInterval);
          ctx.drawImage(validAdvertisement, 0, 100, 300, 300);
          ctx.clearRect(0, 100, width, height);
          subSection--;
        } else if (subSection === 2) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 185, width, height);
          subSection--;
        } else if (subSection === 3) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 250, width, height);
          subSection--;
        }
      }

    }
  }

  function sceneThirteen() {
    //sets the current scene
    currentScene = 13;

    //clears canvas
    ctx.clearRect(0,0,width,height);

    ctx.fillStyle = "rgba(0, 0, 0, 1)";
    ctx.font = "40pt Arial";
    ctx.fillText("Ad Replacement Attack Example", 75, 75);

    //incrementable flag to determine progress through scene
    var subSection = 0;

    window.onkeyup = function(e) {
      var key = e.keyCode ? e.keyCode : e.which;

      if (key === 39) {

        if(subSection === 0) {
          intervals.forEach(clearInterval);
          fadeIn("Intended Advertisement", 100, 160, 15, width);
          ctx.drawImage(validAdvertisement, 50, 175, 300, 300);
          subSection++;
        } else if(subSection === 1) {
          intervals.forEach(clearInterval);
          fadeIn("Fradulant Advertisement", 600, 160, 15, width);
          ctx.drawImage(arrowImage, 400, 300, 100, 50);
          ctx.drawImage(spoofedAdvertisement, 550, 175, 300, 300);
          subSection++;
        } else if(subSection === 2) {
          intervals.forEach(clearInterval);
          sceneFourteen();
        }
      }

      if (key === 37) {
        if (subSection === 0) {
          sceneTwelve();
        } else if (subSection === 1) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 100, width, height);
          subSection--;
        } else if (subSection === 2) {
          intervals.forEach(clearInterval);
          ctx.clearRect(400, 145, width, height);
          subSection--;
        } else if (subSection === 3) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 250, width, height);
          subSection--;
        }
      }

    }
  }


  function sceneFourteen() {
    //sets the current scene
    currentScene = 14;

    //clears canvas
    ctx.clearRect(0,0,width,height);

    ctx.fillStyle = "rgba(0, 0, 0, 1)";
    ctx.font = "30pt Arial";
    ctx.fillText("Ad Replacement Attack: Operational Flow", 75, 75);

    //incrementable flag to determine progress through scene
    var subSection = 0;

    window.onkeyup = function(e) {
      var key = e.keyCode ? e.keyCode : e.which;

      if (key === 39) {

        if(subSection === 0) {
          intervals.forEach(clearInterval);
          restoreAdReplacementScene();
          fadeIn("Step 1.a: Victim machine tries to resolve the IP address of ad.doubleclick.net", 50, 150, 12, 550);
          fadeIn("Step 1.b: Malicious Resolver mis-resolves this to malicious IP 216.180.243.10", 50, 173, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("1.a Resolve ad.doubleclick.net", 250, 214, 12, 250);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("1.b Malicious resolution 216.180.243.10", 250, 275, 12, 285);
          subSection++;
        } else if (subSection === 1) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 2 : The malicious IP serves an iframe to the victim. The iframe directs the victim", 50, 150, 12, 600);
          fadeIn("to banners.awefulnews.com to serve an ad of the same size as the original ad", 50, 173, 12, 600);
          lineDrawDirection(150, 400, 700, 400, 0);
          fadeIn("2. iframe src=http://banners.awefulnews.com/banner.php?size=300*250", 175, 385, 12, 525);
          subSection++;
        } else if (subSection === 2) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 3.a: Victim machine tries to resolve the IP address of banners.awefulnews.com", 50, 150, 12, 600);
          fadeIn("Step 3.b: Malicious Resolver mis-resolves this also to malicious IP 216.180.243.10", 50, 173, 12, 600);
          fadeIn("in order to look legitimate for an scrutinizing ad network", 50, 190, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("3.a Resolve banners.awefulnews.com", 250, 214, 12, 300);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("3.b Malicious resolution 216.180.243.10", 250, 275, 12, 300);
          subSection++;
        } else if (subSection === 3) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 4 : Malicious publisher banners.awefulnews.com will serve an iframe", 50, 150, 12, 600);
          fadeIn("which loads an ad URL that belongs to a different ad network XtendMedia with", 50, 170, 12, 600);
          fadeIn("whom attacker have an account ", 50, 190, 12, 550);
          lineDrawDirection(150, 400, 700, 400, 0);
          fadeIn("4. iframe src=http://ad.xtendmedia.com/st?ad_type=iframe&ad_size=300", 175, 363, 12, 525);
          fadeIn("*250&site=1189752&section_code=blind", 175, 385, 12, 525);
          subSection++;
        } else if (subSection === 4) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 5.a: Victim machine tries to resolve the IP address of ad.xtendmedia.com", 50, 150, 12, 600);
          fadeIn("Step 5.b: Malicious Resolver resolves it correctly as the attacker have an account", 50, 173, 12, 600);
          fadeIn("with this ad network", 50, 190, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("5.a Resolve ad.xtendmedia.com", 250, 214, 12, 300);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("5.b Correct resolution 98.138.49.42", 250, 275, 12, 300);
          subSection++;
        } else if (subSection === 5) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 6.a: XtendMedia serves an ad to the victim machine", 50, 150, 12, 600);
          fadeIn("Step 6.b: Malicious Resolver resolves it correctly. The publisher ID on the displayed", 50, 173, 12, 600);
          fadeIn("ad URL is one of the attackers IDs with that ad network", 50, 190, 12, 550);
          lineDrawDirection(150, 525, 700, 525, 1)
          fadeIn("6.a Advertisement content", 250, 514, 12, 300);
          lineDrawDirection(150, 550, 700, 550, 0)
          fadeIn("6.b http://adxtendmedia.com/st?ad_type=iframe&ad_size=300", 175, 575, 12, 500);
          fadeIn("*250&site=1189752&section_code=blind", 175, 600, 12, 500);
          subSection++;
        } else if (subSection === 6) {
          sceneFifteen();
        }
      }

      if (key === 37) {
        if (subSection === 0) {
          sceneThirteen();
        } else if (subSection === 1) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 100, width, height);
          sceneThirteen();
        } else if (subSection === 2) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0, 100, width, height);
          restoreAdReplacementScene();
          fadeIn("Step 1.a: Victim machine tries to resolve the IP address of ad.doubleclick.net", 50, 150, 12, 550);
          fadeIn("Step 1.b: Malicious Resolver mis-resolves this to malicious IP 216.180.243.10", 50, 173, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("1.a Resolve ad.doubleclick.net", 250, 214, 12, 250);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("1.b Malicious resolution 216.180.243.10", 250, 275, 12, 285);
          subSection--;
        } else if (subSection === 3) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 2 : The malicious IP serves an iframe to the victim. The iframe directs the victim", 50, 150, 12, 600);
          fadeIn("to banners.awefulnews.com to serve an ad of the same size as the original ad", 50, 173, 12, 600);
          lineDrawDirection(150, 400, 700, 400, 0);
          fadeIn("2. iframe src=http://banners.awefulnews.com/banner.php?size=300*250", 175, 385, 12, 525);
          subSection--;
        } else if (subSection === 4) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 3.a: Victim machine tries to resolve the IP address of banners.awefulnews.com", 50, 150, 12, 600);
          fadeIn("Step 3.b: Malicious Resolver mis-resolves this also to malicious IP 216.180.243.10", 50, 173, 12, 600);
          fadeIn("in order to look legitimate for an scrutinizing ad network", 50, 190, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("3.a Resolve banners.awefulnews.com", 250, 214, 12, 300);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("3.b Malicious resolution 216.180.243.10", 250, 275, 12, 300);
          subSection--;
        } else if (subSection === 5) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 4 : Malicious publisher banners.awefulnews.com will serve an iframe", 50, 150, 12, 600);
          fadeIn("which loads an ad URL that belongs to a different ad network XtendMedia with", 50, 170, 12, 600);
          fadeIn("whom attacker have an account ", 50, 190, 12, 550);
          lineDrawDirection(150, 400, 700, 400, 0);
          fadeIn("4. iframe src=http://ad.xtendmedia.com/st?ad_type=iframe&ad_size=300", 175, 363, 12, 525);
          fadeIn("*250&site=1189752&section_code=blind", 175, 385, 12, 525);
          subSection--;
        } else if (subSection === 6) {
          intervals.forEach(clearInterval);
          ctx.clearRect(0,100,width,height);
          restoreAdReplacementScene();
          fadeIn("Step 5.a: Victim machine tries to resolve the IP address of ad.xtendmedia.com", 50, 150, 12, 600);
          fadeIn("Step 5.b: Malicious Resolver resolves it correctly as the attacker have an account", 50, 173, 12, 600);
          fadeIn("with this ad network", 50, 190, 12, 550);
          lineDrawDirection(150, 225, 700, 225, 1)
          fadeIn("5.a Resolve ad.xtendmedia.com", 250, 214, 12, 300);
          lineDrawDirection(150, 250, 700, 250, 0)
          fadeIn("5.b Correct resolution 98.138.49.42", 250, 275, 12, 300);
          subSection--;
        }
      }
    }
  }


    function sceneFifteen() {
      //sets the current scene
      currentScene = 15;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Ad Replacement Attack: Impact", 75, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if(subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("After completing all the series of steps, the attackers collect CPM", 50, 150, 20, width);
            fadeIn("revenue from XtendMedia for displaying an ad from them", 50, 180, 20, width);
            fadeIn("on attacker controlled publisher website banners.awefulnews.com", 50, 210, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("The original ad network DoubleClick and publisher website", 50, 300, 20, width);
            fadeIn("victim visited eBay.com loses ad revenue", 50, 330, 20, width);
            subSection++;
          } else if(subSection === 2) {
            intervals.forEach(clearInterval);
            sceneSixteen();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            sceneFourteen();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            subSection--;
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(400, 145, width, height);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 250, width, height);
            subSection--;
          }
        }

      }
    }

    function sceneSixteen() {
      //sets the current scene
      currentScene = 16;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "40pt Arial";
      ctx.fillText("Click Hijacking Attack", 200, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if(subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Attackers earn CPC revenue by hijacking the clicks ", 50, 150, 20, width);
            fadeIn("specifically made through the search engines", 50, 180, 20, width);
            subSection++;
          } else if(subSection === 1) {
            intervals.forEach(clearInterval);
            fadeIn("This also requires user machine to be infected ", 50, 240, 20, width);
            fadeIn("with DNS Changer Malware.", 50, 270, 20, width);
            subSection++;
          } else if(subSection === 2) {
            intervals.forEach(clearInterval);
            fadeIn("When the user of an infected computer clicks on a search result link", 50, 320, 20, width);
            fadeIn("displayed through a search engine, it takes user to a different website.", 50, 350, 20, width);
            subSection++;
          } else if(subSection === 3) {
            intervals.forEach(clearInterval);
            fadeIn("Example: When the user of an infected computer clicked on domain name link for Netflix,", 80, 380, 15, width);
            fadeIn("the user was instead taken to a website for an unrelated business called BudgetMatch", 80, 405, 15, width);
            subSection++;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            sceneSeventeen();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            intervals.forEach(clearInterval);
            sceneFifteen();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            sceneFifteen();
          } else if (subSection === 2) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 200, width, height);
            subSection--;
          } else if (subSection === 3) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 300, width, height);
            subSection--;
          } else if (subSection === 4) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 360, width, height);
            subSection--;
          }
        }

      }
    }


    function sceneSeventeen() {
      //sets the current scene
      currentScene = 17;

      //clears canvas
      ctx.clearRect(0,0,width,height);

      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "35pt Arial";
      ctx.fillText("Click Hijacking Attack : Participants", 100, 75);

      //incrementable flag to determine progress through scene
      var subSection = 0;

      window.onkeyup = function(e) {
        var key = e.keyCode ? e.keyCode : e.which;

        if (key === 39) {

          if(subSection === 0) {
            intervals.forEach(clearInterval);
            fadeIn("Genuine search engine : google.com", 50, 150, 20, width);
            fadeIn("Fake search engine: accurately-locate.com", 50, 200, 20, width);
            fadeIn("Genuine Advertising Network : looksmart.com", 50, 250, 20, width);
            fadeIn("Malicious front-end Website : bulletindaily.com", 50, 300, 20, width);
            fadeIn("Intermediate Malicious Websites:", 50, 350, 20, width);
            fadeIn("search2.google.com , search3.google.com, 65.60.9.238", 50, 380, 20, width);
            subSection++;
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            sceneEighteen();
          }
        }

        if (key === 37) {
          if (subSection === 0) {
            intervals.forEach(clearInterval);
            sceneSixteen();
          } else if (subSection === 1) {
            intervals.forEach(clearInterval);
            ctx.clearRect(0, 100, width, height);
            subSection--;
          }
        }
      }
    }

    function sceneEighteen() {
        //sets the current scene
        currentScene = 18;

        //clears canvas
        ctx.clearRect(0,0,width,height);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Click Hijacking : Attack Flow", 100, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;
        window.onkeyup = function(e) {
            var key = e.keyCode ? e.keyCode : e.which;

            if (key === 39) {

                if(subSection === 0) {
                    intervals.forEach(clearInterval);
                    restoreClickHijackingScene();
                    fadeIn("Step 1 a : Victim visits google.com, it is resolved correctly by the DNS.", 100, 125, 15, 700);
                    ctx.drawImage(googleScreenshotOne, 500, 200, 300, 300);
                    ctx.drawImage(genericServer, 100, 300, 100, 100);
                    ctx.font = "15pt Arial";
                    ctx.fillText("Malicious DNS", 100, 420);
                    lineDrawDirection(200, 350, 500, 350, 0);
                    subSection++;
                } else if (subSection === 1) {
                    intervals.forEach(clearInterval);
                    restoreClickHijackingScene();
                    fadeIn("Step 1 b : Victim enters search term “Download free antivirus”", 100, 125, 15, 700);
                    fadeIn("which returns a set of results", 100, 150, 15, 700);
                    ctx.drawImage(googleScreenshotTwo, 500, 200, 375, 300);
                    subSection++;
                } else if (subSection === 2) {
                    intervals.forEach(clearInterval);
                    fadeIn("Step 2 : Victim clicks on organic search result free.avg.com which is also", 100, 125, 15, 700);
                    fadeIn("resolved correctly", 100, 150, 15, 700);
                    fadeIn("resolved correctly", 250, 335, 15, 175);
                    subSection++;
                } else if (subSection === 3) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    fadeIn("Step 3 : Victim visits free.avg.com which is resolved correctly", 100, 125, 15, 700);
                    restoreClickHijackingScene();
                    ctx.drawImage(googleScreenshotTwo, 500, 200, 375, 300);
                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 400, 100, 100);

                    ctx.font = "15pt Arial";
                    ctx.fillText("Malicious DNS", 50, 520);
                    ctx.fillText("AVG", 75, 320);

                    lineDraw(150, 300, 500, 350);

                    fadeIn("Referrer : Google.com", 220, 400, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 220, 425, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 220, 450, 12, 275);
                    subSection++;
                } else if (subSection === 4) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();
                    fadeIn("Step 4 : The site free.avg.com attempts to load a Google analytics script ga.js.", 100, 125, 15, 700);
                    fadeIn("The malicious resolver mis-resolves the host name for this script, www.google-", 100, 150, 15, 700);
                    fadeIn("analytics.com, to inject a script 123.php into the parent document.", 100, 175, 15, 700);

                    fadeIn("Referrer : Google.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 540, 575, 12, 275);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 440, 100, 100);
                    ctx.drawImage(genericServer, 225, 440, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 430);
                    ctx.fillText("Google analytics", 50, 540);
                    ctx.fillText("205.234.201.229", 50, 560);
                    ctx.fillText("Search2.google.com", 250, 540);
                    ctx.fillText("67.210.14.53", 250, 560);

                    ctx.beginPath();
                    ctx.rect(525, 275, 325, 200);
                    ctx.stroke();

                    ctx.font = "12pt Arial";
                    ctx.fillText("<script src=“google-analytics/ga.js”>", 540, 250);
                    ctx.fillText("Import", 540, 350);
                    ctx.fillText("search2.google.com/123.php?referrer=…", 540, 365);

                    ctx.fillText("Request to DNS to resolve", 200, 275);
                    ctx.fillText("host name of ga.js", 200, 290);

                    ctx.fillText("correct", 175, 500);
                    ctx.fillText("Mis-resolves to search2…", 225, 425);
                    ctx.fillText("which hosts 123.php", 225, 450);

                    lineDraw(160, 400, 500, 250);
                    lineDraw(160, 400, 160, 500);
                    lineDraw(160, 400, 240, 500);

                    subSection++;
                } else if (subSection === 5) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 5 : The script sends the referrer , www.google.com, search terms entered by ", 100, 125, 15, 720);
                    fadeIn("the victim, as well as the original site the victim clicked on to another non-existent", 100, 150, 15, 720);
                    fadeIn("host name, search3.google.com", 100, 175, 15, 720);

                    ctx.beginPath();
                    ctx.rect(525, 275, 325, 200);
                    ctx.rect(535, 325, 290, 140);
                    ctx.stroke();

                    ctx.font = "12pt Arial";
                    ctx.fillText("<script src=“google-analytics/ga.js”>", 540, 250);
                    ctx.fillText("Import", 540, 300);
                    ctx.fillText("search2.google.com/123.php?referrer=…", 540, 315);
                    ctx.fillText("Import", 540, 360);
                    ctx.fillText("search3.google.com/?Google+AVG+xxx", 540, 375);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);
                    ctx.drawImage(genericServer, 325, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 420);
                    ctx.fillText("Search2.google.com", 50, 595);
                    ctx.fillText("Search3.google.com", 350, 595);

                    fadeIn("Referrer : Google.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 540, 575, 12, 275);

                    fadeIn("Passes referrer + search", 150, 515, 12, 190);
                    fadeIn("term + intended website", 150, 535, 12, 190);

                    lineDraw(100, 430, 100, 510);
                    lineDraw(130, 550, 345, 550);

                    subSection++;
                } else if (subSection === 6) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 6 : The host search3.google.com has access to referrer site, search terms", 100, 125, 15, 720);
                    fadeIn("and website victim intended to visit. If referrer is a search engine victim is sent to", 100, 150, 15, 720);
                    fadeIn("an attacker controlled front-end website bulletindaily.com", 100, 175, 15, 720);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 350, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 450);
                    ctx.fillText("Bulletindaily.com", 50, 595);

                    fadeIn("Sent to attacker", 250, 500, 12, 240);
                    fadeIn("controlled front-end", 250, 525, 12, 240);
                    fadeIn("website bulletindaily.com", 250, 550, 12, 250);
                    fadeIn("which is new referrer", 250, 575, 12, 250);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    ctx.fillText("Import", 530, 275);
                    ctx.fillText("search3.google.com/?Google+AVG+download…", 530, 290);
                    ctx.fillText("{load bulletindaily.com/?parameter}", 530, 310);

                    lineDraw(500, 300, 150, 550);
                    subSection++;
                } else if (subSection === 7) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 7 : The front-end website bulletindaily.com contains a form to submit search ", 100, 125, 15, 720);
                    fadeIn("terms to another malicious IP, 65.60.9.238", 100, 150, 15, 720);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 350, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 450);
                    ctx.fillText(" Form click IP: 65.60.9.238", 50, 595);

                    fadeIn("Referrer:", 250, 500, 12, 240);
                    fadeIn("bulletdaily.com", 250, 525, 12, 240);

                    ctx.fillText("Bulletindaily.com", 530, 190);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    lineDraw(500, 300, 150, 550);

                    subSection++;
                } else if (subSection === 8) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 8 : The IP, 65.60.9.238, chooses to monetize the click by passing it through", 100, 125, 15, 720);
                    fadeIn("an affiliated fake search engine, accurately-locate.com, using a 302 redirect", 100, 150, 15, 720);

                    ctx.fillText("Bulletindaily.com", 530, 190);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    ctx.font = "12pt Arial";
                    ctx.fillText("Fake search engine", 25, 300);
                    ctx.fillText("accurately-locate.com", 25, 315);

                    ctx.fillText("AVG", 50, 450);
                    ctx.fillText("Malicious DNS", 50, 595);
                    ctx.fillText("Form click IP: 65.60.9.238", 250, 595);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    fadeIn("HTTP 302 redirect accurately", 250, 300, 12, 240);
                    fadeIn("locate.com/?keyword=do", 250, 325, 12, 240);
                    fadeIn("wnload&itemid", 250, 350, 12, 240);
                    fadeIn("Refferer=bulletindaily.com", 250, 375, 12, 240);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);
                    ctx.drawImage(genericServer, 325, 500, 100, 100);

                    lineDraw(150, 250, 300, 550);
                    subSection++;
                } else if (subSection === 9) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 9 : The fake search engine, accurately-locate.com, has access to the victims", 100, 125, 15, 720);
                    fadeIn("search terms. It uses them to generate a click on one of its sponsored results", 100, 150, 15, 720);
                    fadeIn("buy.norton.com which is retrieved from search ad network looksmart.com", 100, 175, 15, 720);

                    ctx.fillText("Bulletindaily.com", 530, 200);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    ctx.drawImage(genericServer, 200, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 420, 100, 100);
                    ctx.drawImage(genericServer, 300, 420, 100, 100);

                    fadeIn("HTTP 302 redirect", 250, 360, 12, 240);
                    fadeIn("/?keyword=download..&itemid", 250, 385, 12, 240);
                    fadeIn("Refferer=bulletindaily.com", 250, 410, 12, 240);

                    ctx.font = "12pt Arial";
                    ctx.fillText("Fake search engine", 150, 300);
                    ctx.fillText("accurately-locate.com", 150, 315);
                    ctx.fillText("Search Ad Network", 50, 530);
                    ctx.fillText("Looksmart.com", 50, 545);
                    ctx.fillText("Form click IP", 250, 530);
                    ctx.fillText("65.60.9.238", 250, 545);

                    lineDraw(250, 325, 150, 450);
                    subSection++;
                } else if (subSection === 10) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();
                    fadeIn("Step 10-11 : Looksmart.com redirects the victim to buy.norton.com", 100, 125, 15, 720);
                    ctx.drawImage(genericServer, 50, 420, 100, 100);
                    ctx.font = "12pt Arial";
                    ctx.fillText("Referrer: bulletdaily.com", 150, 300);
                    ctx.fillText("Search Ad Network", 50, 530);
                    ctx.fillText("Looksmart.com", 50, 545);
                    lineDraw(150, 500, 500, 300)
                    ctx.drawImage(nortonScreenshot, 500, 200, 375, 300);
                    subSection++;
                    sceneNineteen();
                }
            }

            if (key === 37) {
                if (subSection === 0) {
                    intervals.forEach(clearInterval);
                    sceneSixteen();
                } else if (subSection === 1) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    subSection--;
                } else if (subSection === 2) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();
                    fadeIn("Step 1 a : Victim visits google.com, it is resolved correctly by the DNS.", 100, 125, 15, 700);
                    ctx.drawImage(googleScreenshotOne, 500, 200, 300, 300);
                    ctx.drawImage(genericServer, 100, 300, 100, 100);
                    ctx.font = "15pt Arial";
                    ctx.fillText("Malicious DNS", 100, 420);
                    lineDrawDirection(200, 350, 500, 350, 0);
                    subSection--;
                } else if (subSection === 3) {
                    restoreClickHijackingScene();
                    fadeIn("Step 1 b : Victim enters search term “Download free antivirus”", 100, 125, 15, 700);
                    fadeIn("which returns a set of results", 100, 150, 15, 700);
                    ctx.drawImage(googleScreenshotTwo, 500, 200, 375, 300);
                    ctx.clearRect(235, 295, 200, 50);
                    subSection--;
                } else if (subSection === 4) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();
                    fadeIn("Step 2 : Victim clicks on organic search result free.avg.com which is also", 100, 125, 15, 700);
                    fadeIn("resolved correctly", 100, 150, 15, 700);
                    fadeIn("resolved correctly", 250, 335, 15, 175);
                    ctx.drawImage(googleScreenshotOne, 500, 200, 300, 300);
                    ctx.drawImage(genericServer, 100, 300, 100, 100);
                    ctx.font = "15pt Arial";
                    ctx.fillText("Malicious DNS", 100, 420);
                    lineDrawDirection(200, 350, 500, 350, 0);
                    subSection--;
                } else if (subSection === 5) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    fadeIn("Step 3 : Victim visits free.avg.com which is resolved correctly", 100, 125, 15, 700);
                    restoreClickHijackingScene();
                    ctx.drawImage(googleScreenshotTwo, 500, 200, 375, 300);
                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 400, 100, 100);

                    ctx.font = "15pt Arial";
                    ctx.fillText("Malicious DNS", 50, 520);
                    ctx.fillText("AVG", 75, 320);

                    lineDraw(150, 300, 500, 350);

                    fadeIn("Referrer : Google.com", 220, 400, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 220, 425, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 220, 450, 12, 275);
                    subSection--;
                } else if (subSection === 6) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();
                    fadeIn("Step 4 : The site free.avg.com attempts to load a Google analytics script ga.js.", 100, 125, 15, 700);
                    fadeIn("The malicious resolver mis-resolves the host name for this script, www.google-", 100, 150, 15, 700);
                    fadeIn("analytics.com, to inject a script 123.php into the parent document.", 100, 175, 15, 700);

                    fadeIn("Referrer : Google.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 540, 575, 12, 275);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 440, 100, 100);
                    ctx.drawImage(genericServer, 225, 440, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 430);
                    ctx.fillText("Google analytics", 50, 540);
                    ctx.fillText("205.234.201.229", 50, 560);
                    ctx.fillText("Search2.google.com", 250, 540);
                    ctx.fillText("67.210.14.53", 250, 560);

                    ctx.beginPath();
                    ctx.rect(525, 275, 325, 200);
                    ctx.stroke();

                    ctx.font = "12pt Arial";
                    ctx.fillText("<script src=“google-analytics/ga.js”>", 540, 250);
                    ctx.fillText("Import", 540, 350);
                    ctx.fillText("search2.google.com/123.php?referrer=…", 540, 365);

                    ctx.fillText("Request to DNS to resolve", 200, 275);
                    ctx.fillText("host name of ga.js", 200, 290);

                    ctx.fillText("correct", 175, 500);
                    ctx.fillText("Mis-resolves to search2…", 225, 425);
                    ctx.fillText("which hosts 123.php", 225, 450);

                    lineDraw(160, 400, 500, 250);
                    lineDraw(160, 400, 160, 500);
                    lineDraw(160, 400, 240, 500);

                    subSection--;
                } else if (subSection === 7) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 5 : The script sends the referrer , www.google.com, search terms entered by ", 100, 125, 15, 720);
                    fadeIn("the victim, as well as the original site the victim clicked on to another non-existent", 100, 150, 15, 720);
                    fadeIn("host name, search3.google.com", 100, 175, 15, 720);

                    ctx.beginPath();
                    ctx.rect(525, 275, 325, 200);
                    ctx.rect(535, 325, 290, 140);
                    ctx.stroke();

                    ctx.font = "12pt Arial";
                    ctx.fillText("<script src=“google-analytics/ga.js”>", 540, 250);
                    ctx.fillText("Import", 540, 300);
                    ctx.fillText("search2.google.com/123.php?referrer=…", 540, 315);
                    ctx.fillText("Import", 540, 360);
                    ctx.fillText("search3.google.com/?Google+AVG+xxx", 540, 375);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);
                    ctx.drawImage(genericServer, 325, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 420);
                    ctx.fillText("Search2.google.com", 50, 595);
                    ctx.fillText("Search3.google.com", 350, 595);

                    fadeIn("Referrer : Google.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);
                    fadeIn("Intended website: free.avg.com  ", 540, 575, 12, 275);

                    fadeIn("Passes referrer + search", 150, 515, 12, 190);
                    fadeIn("term + intended website", 150, 535, 12, 190);

                    lineDraw(100, 430, 100, 510);
                    lineDraw(130, 550, 345, 550);

                    subSection--;
                } else if (subSection === 8) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 6 : The host search3.google.com has access to referrer site, search terms", 100, 125, 15, 720);
                    fadeIn("and website victim intended to visit. If referrer is a search engine victim is sent to", 100, 150, 15, 720);
                    fadeIn("an attacker controlled front-end website bulletindaily.com", 100, 175, 15, 720);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 350, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 450);
                    ctx.fillText("Bulletindaily.com", 50, 595);

                    fadeIn("Sent to attacker", 250, 500, 12, 240);
                    fadeIn("controlled front-end", 250, 525, 12, 240);
                    fadeIn("website bulletindaily.com", 250, 550, 12, 240);
                    fadeIn("which is new referrer", 250, 575, 12, 240);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    ctx.fillText("Import", 530, 275);
                    ctx.fillText("search3.google.com/?Google+AVG+download…", 530, 290);
                    ctx.fillText("{load bulletindaily.com/?parameter}", 530, 310);

                    lineDraw(500, 300, 150, 550);
                    subSection--;
                } else if (subSection === 9) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 7 : The front-end website bulletindaily.com contains a form to submit search ", 100, 125, 15, 720);
                    fadeIn("terms to another malicious IP, 65.60.9.238", 100, 150, 15, 720);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 350, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);

                    ctx.font = "12pt Arial";
                    ctx.fillText("AVG", 75, 300);
                    ctx.fillText("Malicious DNS", 50, 450);
                    ctx.fillText(" Form click IP: 65.60.9.238", 50, 595);

                    fadeIn("Referrer:", 250, 500, 12, 240);
                    fadeIn("bulletdaily.com", 250, 525, 12, 240);

                    ctx.fillText("Bulletindaily.com", 530, 190);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    lineDraw(500, 300, 150, 550);

                    subSection--;
                } else if (subSection === 10) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 8 : The IP, 65.60.9.238, chooses to monetize the click by passing it through", 100, 125, 15, 720);
                    fadeIn("an affiliated fake search engine, accurately-locate.com, using a 302 redirect", 100, 150, 15, 720);

                    ctx.fillText("Bulletindaily.com", 530, 190);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    ctx.font = "12pt Arial";
                    ctx.fillText("Fake search engine", 25, 300);
                    ctx.fillText("accurately-locate.com", 25, 315);

                    ctx.fillText("AVG", 50, 450);
                    ctx.fillText("Malicious DNS", 50, 595);
                    ctx.fillText("Form click IP: 65.60.9.238", 250, 595);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    fadeIn("HTTP 302 redirect accurately", 250, 300, 12, 240);
                    fadeIn("locate.com/?keyword=do", 250, 325, 12, 240);
                    fadeIn("wnload&itemid", 250, 350, 12, 240);
                    fadeIn("Refferer=bulletindaily.com", 250, 375, 12, 240);

                    ctx.drawImage(genericServer, 50, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 320, 100, 100);
                    ctx.drawImage(genericServer, 50, 500, 100, 100);
                    ctx.drawImage(genericServer, 325, 500, 100, 100);

                    lineDraw(150, 250, 300, 550);
                    subSection--;
                } else if (subSection === 11) {
                    intervals.forEach(clearInterval);
                    ctx.clearRect(0, 100, width, height);
                    restoreClickHijackingScene();

                    fadeIn("Step 9 : The fake search engine, accurately-locate.com, has access to the victims", 100, 125, 15, 720);
                    fadeIn("search terms. It uses them to generate a click on one of its sponsored results", 100, 150, 15, 720);
                    fadeIn("buy.norton.com which is retrieved from search ad network looksmart.com", 100, 175, 15, 720);

                    ctx.fillText("Bulletindaily.com", 530, 200);
                    ctx.fillText("<from action=“65.60.9.238/?param”>", 530, 275);
                    ctx.fillText("<script> submit form <script>", 530, 290);

                    fadeIn("Referrer : bulletdaily.com", 540, 525, 12, 275);
                    fadeIn("Search Term: Download free antivirus", 540, 550, 12, 275);

                    ctx.drawImage(genericServer, 200, 200, 100, 100);
                    ctx.drawImage(genericServer, 50, 420, 100, 100);
                    ctx.drawImage(genericServer, 300, 420, 100, 100);

                    fadeIn("HTTP 302 redirect", 250, 360, 12, 240);
                    fadeIn("/?keyword=download..&itemid", 250, 385, 12, 240);
                    fadeIn("Refferer=bulletindaily.com", 250, 410, 12, 240);

                    ctx.font = "12pt Arial";
                    ctx.fillText("Fake search engine", 150, 300);
                    ctx.fillText("accurately-locate.com", 150, 315);
                    ctx.fillText("Search Ad Network", 50, 530);
                    ctx.fillText("Looksmart.com", 50, 545);
                    ctx.fillText("Form click IP", 250, 530);
                    ctx.fillText("65.60.9.238", 250, 545);

                    lineDraw(250, 325, 150, 450);
                    subSection--;
                }
            }
        }
    }

    function sceneNineteen() {
        //sets the current scene
        currentScene = 19;

        //clears canvas
        ctx.clearRect(0,0,width,height);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Click Hijacking Attack: Impact", 100, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;

        window.onkeyup = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;

          if (key === 39) {

            if (subSection === 0) {
                intervals.forEach(clearInterval);
                fadeIn("The attackers defrauded avg.com by stealing its traffic impacting its revenue", 60, 150, 17, width);
                subSection++;
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                fadeIn("Search ad network LookSmart and Norton were defrauded by simulating a click on ", 60, 200, 17, width);
                fadeIn("Norton’s textual ad and collecting CPC revenue from LookSmart through its affiliate fake search engine.", 60, 230, 17, width);
                fadeIn("fake search engine.", 60, 260, 17, width);
                subSection++;
                sceneTwenty();
            }
          }

          if (key === 37) {
            if (subSection === 0) {
                intervals.forEach(clearInterval);
                sceneNineteen();
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 100, width, height);
                subSection--;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 180, width, height);
                subSection--;
            }
          }
        }
    }

    function sceneTwenty() {
        //sets the current scene
        currentScene = 20;

        //clears canvas
        ctx.clearRect(0,0,width,height);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Ad Fraud Mitigation Techniques", 75, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;

        window.onkeyup = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;

          if (key === 39) {

            if (subSection === 0) {
                intervals.forEach(clearInterval);
                fadeIn("Serve Bluff Ads*", 35, 150, 17, width);
                subSection++;
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                fadeIn("A mechanism to detect click activities from a machine or ", 45, 200, 17, width);
                fadeIn("poorly trained click-fraud workforce", 45, 230, 17, width);
                fadeIn("In this mechanism, whenever a user (can be genuine, ", 45, 290, 17, width);
                fadeIn("botnet or click-fraud workforce) visits", 45, 320, 17, width);
                fadeIn("a publisher page, Ad network serve the user with probability p(i)", 45, 350, 17, width);
                fadeIn("with ads matching user profile.", 45, 380, 17, width);
                fadeIn("Serve ads completely unrelated to user profile with probability (1-p(i))", 45, 440, 17, width);
                fadeIn("For example, serve ads or car sale in Greensboro to an user browsing in India.", 75, 470, 17, width);
                subSection++;
                sceneTwentyOne();
            }
          }

          if (key === 37) {
            if (subSection === 0) {
                intervals.forEach(clearInterval);
                sceneNineteen();
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 100, width, height);
                subSection--;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 180, width, height);
                subSection--;
            }
          }
        }
    }


    function sceneTwentyOne() {
        //sets the current scene
        currentScene = 21;

        //clears canvas
        ctx.clearRect(0,0,width,height);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Ad Fraud Mitigation Techniques", 75, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;

        window.onkeyup = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;

          if (key === 39) {

            if (subSection === 0) {
                intervals.forEach(clearInterval);
                fadeIn("Serve Bluff Ads*", 35, 150, 17, width);
                subSection++;
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                fadeIn("Ad network can monitor the ratio of clicks on bluff ad and real ad.", 45, 230, 17, width);
                fadeIn("If Bluff/real ratio is higher than average user then it is", 45, 290, 17, width);
                fadeIn("indicative of botnet or fraud agents are in operation", 45, 320, 17, width);
                fadeIn("-Fraud agents are just clicking for publishers or against a specific advertiser", 75, 350, 17, width);
                fadeIn("-Clickbots are automated programs that performs common functions including", 75, 380, 17, width);
                fadeIn(" HTTP requests to a web server, following redirections and retrieving contents", 75, 410, 17, width);
                fadeIn(" from a web server", 75, 440, 17, width);
                fadeIn("Bluff ads should be authentic ads of different advertisers, spread in the network", 45, 500, 17, width);
                fadeIn("and shown randomly but never charged for.", 45, 530, 17, width);
                subSection++;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                sceneTwentyTwo();
            }
          }

          if (key === 37) {
            if (subSection === 0) {
                intervals.forEach(clearInterval);
                sceneTwenty();
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 100, width, height);
                subSection--;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 180, width, height);
                subSection--;
            }
          }
        }
    }

    function sceneTwentyTwo() {
        //sets the current scene
        currentScene = 22;

        //clears canvas
        ctx.clearRect(0,0,width,height);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Ad Fraud Mitigation Techniques", 75, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;

        window.onkeyup = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;

          if (key === 39) {

            if (subSection === 0) {
                intervals.forEach(clearInterval);
                fadeIn("Threshold based detection*", 35, 150, 17, width);
                subSection++;
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                fadeIn("If a web page is receiving a high number of clicks from", 45, 190, 17, width);
                fadeIn("the same IP address in a short interval, these clicks can be flagged fraud", 45, 220, 17, width);
                fadeIn("The detection get complicated if the clickers", 45, 280, 17, width);
                fadeIn("are  behind proxies or globally distributed", 45, 310, 17, width);
                fadeIn("In this case, Ad network has to use global IP blacklists and update its list", 45, 380, 17, width);
                subSection++;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                sceneTwentyThree();
            }
          }

          if (key === 37) {
            if (subSection === 0) {
                intervals.forEach(clearInterval);
                sceneTwentyOne();
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 100, width, height);
                subSection--;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 150, width, height);
                subSection--;
            }
          }
        }
    }

    function sceneTwentyThree() {
        //sets the current scene
        currentScene = 23;

        //clears canvas
        ctx.clearRect(0,0,width,height);
        intervals.forEach(clearInterval);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.font = "40pt Arial";
        ctx.fillText("Ad Fraud Mitigation Techniques", 75, 75);

        //incrementable flag to determine progress through scene
        var subSection = 0;

        window.onkeyup = function(e) {
          var key = e.keyCode ? e.keyCode : e.which;

          if (key === 39) {

            if (subSection === 0) {
                intervals.forEach(clearInterval);
                fadeIn("Monitoring and Scrutinizing unexpected DNS resolvers", 35, 150, 17, width);
                subSection++;
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                fadeIn("-One of the major attributes of Ad replacement and click ", 45, 190, 17, width);
                fadeIn(" hijacking attack is incorrect reconfiguration of victim’s", 45, 220, 17, width);
                fadeIn(" DNS resolver settings to attacker-controlled machines", 45, 250, 17, width);
                fadeIn("-Internet Service Providers (ISPs) can monitor DNS requests and responses", 45, 310, 17, width);
                fadeIn(" traversing their organizational borders to find unexpected DNS resolvers", 45, 340, 17, width);
                subSection++;
            }
          }

          if (key === 37) {
            if (subSection === 0) {
                intervals.forEach(clearInterval);
                sceneTwentyTwo();
            } else if (subSection === 1) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 100, width, height);
                subSection--;
            } else if (subSection === 2) {
                intervals.forEach(clearInterval);
                ctx.clearRect(0, 160, width, height);
                subSection--;
            }
          }
        }
    }



    //building animation for text fading in
    function fadeIn(text, x, y, fontSize, textWidth) {
      var aNumber = 1;
      var alpha = 0.0;
      fadeInInterval = setInterval(function () {
        ctx.clearRect(x, y-fontSize-5, textWidth, fontSize+15); // Clears the canvas
        ctx.fillStyle = "rgba(0, 0, 0, " + alpha + ")";
        ctx.font = fontSize + "pt Arial";
        ctx.fillText(text, x, y);
        alpha = alpha + 0.05; // increase opacity (fade in)

        if (alpha > 1) {
          clearInterval(fadeInInterval);
        }
      }, 70);
      intervals.push(fadeInInterval);
    }

    //text fade out animation
    function fadeOut(text, x, y, fontSize, textWidth) {
      var alpha = 1.0;   // full opacity
      fadeOutInterval = setInterval(function () {
        ctx.clearRect(x, y-fontSize-5, textWidth, fontSize+15); // Clears the canvas
        ctx.fillStyle = "rgba(0, 0, 0, " + alpha + ")";
        ctx.font = fontSize + "pt Arial";
        ctx.fillText(text, x, y);
        alpha = alpha - 0.05; // decrease opacity (fade out)
        if (alpha < 0) {
          ctx.clearRect(x, y-fontSize-5, textWidth, fontSize+15);
          clearInterval(fadeOutInterval);
        }
      }, 100);

      intervals.push(fadeOutInterval);
    }

    function lineDraw(startX, startY, endX, endY) {
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.lineTo(endX, endY);
      ctx.stroke();
    }

    //give direction 0 if left and direction 1 if right
    function lineDrawDirection(startX, startY, endX, endY, direction) {
      //draws the line
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.lineTo(endX, endY);
      ctx.stroke();

      //draws the triangle part of the arrow
      if (direction == 0) {
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(startX+15, startY-15);
        ctx.lineTo(startX+15, startY+15);
        ctx.fill();
      } else if (direction == 1) {
        ctx.beginPath();
        ctx.moveTo(endX, endY);
        ctx.lineTo(endX-15, startY-15);
        ctx.lineTo(endX-15, startY+15);
        ctx.fill();
      }
    }

    //this is a long function that I think can be abstracted later but I don't
    //want to deal with that right now so here it is
    function moveImage(image, startX, startY, endX, endY, imageWidth, imageHeight) {

      var currentX = startX;
      var currentY = startY;

      moveTimer = setInterval(function() {
        //I added +/- 1 because in some cases it wasn't completely clearing the old image
        ctx.clearRect(currentX-1, currentY-1, imageWidth+1, imageHeight+1);
        ctx.drawImage(image, currentX, currentY, imageWidth, imageHeight);

        if (endX > currentX) {
          currentX++;
        } else if(endX < currentX) {
          currentX--;
        }

        if (endY > currentY) {
          currentY++;
        } else if(endY < currentY) {
          currentY--;
        }

        if (currentX === endX && currentY === endY) {
          clearInterval(moveTimer);
        }

      }, 6)
      intervals.push(moveTimer);
    }

    //fades in images
    function imageFadeIn(image, x, y, w, h) {
      var alpha = 0.0;

      fadeInImageInterval = setInterval(function() {
        ctx.clearRect(x-1, y-1, w+1, h+1);
        ctx.globalAlpha = alpha;
        ctx.drawImage(image, x, y, w, h);
        alpha += .05;

        if (alpha > 1) {
          //resets globalAlpha
          ctx.globalAlpha = 1;
          clearInterval(fadeInImageInterval);
        }

      }, 99)

      intervals.push(fadeInImageInterval);
    }

    function imageFadeOut(image, x, y, w, h) {
      var alpha = 1.0;
      ctx.drawImage(image, x, y, w, h);
      fadeOutImageInterval = setInterval(function() {
        ctx.clearRect(x-1, y-1, w+1, h+1);
        ctx.globalAlpha = alpha;
        ctx.drawImage(image, x, y, w, h);
        alpha -= .05;

        if (alpha < 0) {
          ctx.globalAlpha = 1;
          ctx.clearRect(x-1, y-1, w+1, h+1);
          clearInterval(fadeOutImageInterval);
        }

      }, 99)

      intervals.push(fadeOutImageInterval);
    }

    function restoreDNSPoisoningScene() {
      intervals.forEach(clearInterval);
      ctx.clearRect(0,0,width,height);
      ctx.fillStyle = "rgba(0, 0, 0, 1)";
      ctx.font = "30pt Arial";
      ctx.fillText("DNS Cache Poisoning", 250, 50);
      ctx.drawImage(attacker, 50, 440, 125, 100);
      ctx.drawImage(localDNS, 750, 440, 125, 100);
      ctx.drawImage(internetDNS, 400, 150, 100, 100);
      ctx.font = "15pt Arial";
      ctx.fillText("Attacker", 70, 590);
      ctx.fillText("Local DNS", 750, 590);
      ctx.fillText("Internet DNS", 390, 290);
    }

    function restoreAdReplacementScene() {
      intervals.forEach(clearInterval);
      ctx.drawImage(user, 50, 250, 100, 100)
      ctx.drawImage(maliciousResolver, 700, 150, 100, 150);
      ctx.drawImage(maliciousIP, 700, 360, 100, 100);
      ctx.drawImage(adNetwork, 700, 500, 75, 75);
      ctx.font = "12pt Arial";
      ctx.fillText("Victim Machine", 50, 375);
      ctx.fillText("Malicious Resolver", 700, 330);
      ctx.fillText("(213.109.64.5)", 700, 360);
      ctx.fillText("Malicious IP", 775, 450);
      ctx.fillText("(216.180.243.10)", 775, 490);
      ctx.fillText("Ad Network", 775, 550);
    }

    function restoreClickHijackingScene() {
      intervals.forEach(clearInterval);
      ctx.beginPath();
      //needs a clear rect function
      ctx.rect(500, 200, 375, 300);
      ctx.stroke();
    }

    </script>

  </head>

  <body onLoad="init();">
  <div id="canvas-div">
    <canvas id="canvas" width="900" height="600"></canvas>
  </div>
  </body>
  </html>
